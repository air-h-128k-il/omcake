# omcake v0.1

古林敬一先生 @keiichif が作成された小規模医療機関向けの（古林先生曰く）「電子カルテ（もどき）」です。
機能的には未実装の箇所も多いですが、この分野に興味のある人は教育用にいいのではないでしょうか。

## 動作環境等

ORCAサーバから api を介して受付患者のリストを取得しますので、ORCA 必須。

古林先生の環境とは若干異なり
MacOS monterery  postgresql12  PHP8.1 cakePHP4.2
で試験的に動かしたところ、問題なく動きました。
PHP に OS 依存はほとんどないはずなので、win でも動くと思います。

## インストール方法
PostgreSQL に mr というデータベースを作成し、datasource の接続情報をそれに合わせて修正。
ダウンロードしたフォルダの mr フォルダに入り、
`bin/cake server -H localhost`
でビルドインサーバーが起動します。
あとはブラウザから閲覧・操作。

## ライセンス
GPLv3 だそうです

-----------------------------------------------------
以下は、古林先生の　README から。

* ORCAとの連携はORCA→omcakeの一方向。
* エラー処理してません！（CakePHPのデバッガが頼り^^;;）
* セキュリティはIPアドレス制限のみ。ログイン機能なし。

チケットプリンタで「受付順番チケット」を発行する機能をつけてます。（bashを呼んでるだけです。）

ショボいけど、食べてみてください。味は保証しません！

## 謝辞

* 半角から全角へ変換するpostgres用関数(https://postgresweb.com/post-2295)
を使わせてもらっています。
* 電子カルテでは変更履歴をすべて残しておく必要があります。omcakeではOpenDolphinと同じく、差分を記録しないで保存時刻の異なるデータが貯まるようにしています。そして、保存時刻が最新のレコードを普段は表示させるために「同一グループの中で最大のレコードを取得する SQL を書く」(https://www.timedia.co.jp/tech/selecting-max-record-in-group-by/)
が必須でした。これを知ったのでomcakeはできたようなものです。

